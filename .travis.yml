language: cpp

# install a updated version of g++ for C++11 support
matrix:
    include:
        - os: linux
          addons:
            apt:
                sources:
                    - ubuntu-toolchain-r-test
                packages:
                    - g++-4.9
          env:
            - MATRIX_EVAL="CC=gcc-4.9 && CXX=g++-4.9"
# pull the git submodules myself
git:
    submodules: false

# install the dbgfm thirdparty dependency
before_install:
    - eval "${MATRIX_EVAL}"
    - sed -i 's/git@github.com:/https:\/\/github.com\//' .gitmodules
    - git submodule update --init --recursive
    - cd thirdparty/dbgfm && make && cd -

install:
    - autoreconf --install
    - ./configure
    - make
    - export PATH=$PATH:$PWD:$PWD/test/

# install the test binary
before_script:
    - cd test && make && cd -

script:
    - cd test && kleuren-test && cd -
